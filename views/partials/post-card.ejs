<div class="post-card">
  <div class="post-header">
    <a href="/user/<%= post.author._id %>">
      <img src="<%= post.author.profilePhoto %>" alt="<%= post.author.username %>" class="post-avatar">
      <span class="post-author"><%= post.author.username %></span>
    </a>
    <span class="post-date"><%= new Date(post.createdAt).toLocaleDateString() %></span>
  </div>
  
  <div class="post-content">
    <p><%= post.content %></p>
    <% if (post.image) { %>
      <img src="<%= post.image %>" alt="Post image" class="post-image">
    <% } %>
  </div>
  
  <div class="post-actions">
    <button class="like-btn" data-post-id="<%= post._id %>">
      <span class="like-icon"><%= post.likes.includes(currentUser._id) ? 'â¤ï¸' : 'ðŸ¤' %></span>
      <span class="like-count"><%= post.likes.length %></span>
    </button>
    <span class="comment-count">ðŸ’¬ <%= post.comments.length %></span>
    
    <% if (currentUser && currentUser._id.toString() === post.author._id.toString()) { %>
      <div class="post-controls">
        <a href="/post/<%= post._id %>/edit" class="btn-small">Edit</a>
        <form action="/post/<%= post._id %>/delete" method="POST" style="display: inline;">
          <button type="submit" class="btn-small btn-danger" onclick="return confirm('Are you sure?')">Delete</button>
        </form>
      </div>
    <% } %>
  </div>
  
  <div class="comments-section">
    <% if (post.comments.length > 0) { %>
      <div class="comments-list">
        <% post.comments.forEach(comment => { %>
          <div class="comment">
            <a href="/user/<%= comment.author._id %>">
              <img src="<%= comment.author.profilePhoto %>" alt="<%= comment.author.username %>" class="comment-avatar">
            </a>
            <div class="comment-content">
              <a href="/user/<%= comment.author._id %>" class="comment-author"><%= comment.author.username %></a>
              <p><%= comment.content %></p>
              <span class="comment-date"><%= new Date(comment.createdAt).toLocaleDateString() %></span>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
    
    <form action="/post/<%= post._id %>/comment" method="POST" class="comment-form">
      <input type="text" name="content" placeholder="Add a comment..." required maxlength="500">
      <button type="submit" class="btn-small">Post</button>
    </form>
  </div>
</div>
